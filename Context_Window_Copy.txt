# CONTEXT_WINDOW_COPY: SENTINEL PROJECT SERIALIZATION

## 1. PROJECT IDENTITY
- **Project Name**: Sentinel [CONFIRMED]
- **Internal Codenames**: 
    - SDT-IS (Sentinel Defense Technologies Information System) [CONFIRMED]
    - Intelligence Node (Server Backend) [CONFIRMED]
    - Tactical Interface (Android Frontend) [CONFIRMED]
    - Command Controller (Admin Console) [CONFIRMED]
    - The Watchman (Android logic name) [CONFIRMED]
    - The Conflict Agent (Backend script name) [CONFIRMED]
- **Purpose Primary**: To mitigate civilian risk in high-kinetic conflict zones by providing real-time, AI-verified intelligence, predictive forecasting, and evacuation logistics. [CONFIRMED]
- **Purpose Secondary**: Provide a "Ground Truth" for humanitarian corridors. [INFERRED]
- **Purpose Tertiary**: Public awareness/investment via transparency (Website). [INFERRED]
- **Problem Solved**: High-latency, unverified, or fragmented intelligence for civilians during active conflict. [CONFIRMED]
- **Problem Not Solved**: Direct combat engagement, offensive tactical planning, or real-time weapon tracking for military use. [ASSUMED]
- **Target Users**: 
    - Civilians in or near active conflict zones (Explicit) [CONFIRMED]
    - NGO/Humanitarian aid workers (Implicit) [ASSUMED]
    - Decision makers/Analysts (Explicit) [CONFIRMED]
- **Threat/Failure Model**: 
    - **Threat**: Misinformation/Drift leading to dangerous routing. [CONFIRMED]
    - **Threat**: System-gated alerts (DEFCON 1-2) causing delay in human-verified panic response. [ASSUMED]
    - **Failure**: Server downtime leading to "stale" intel (handled by 72h grey-out logic). [CONFIRMED]

## 2. DESIGN PHILOSOPHY & PRINCIPLES
- **Core Principles**: 
    - **Safety over Speed**: High-severity alerts require human verification (HITL). [CONFIRMED]
    - **Privacy First (PDPA)**: Ephemeral ID rotation every 24 hours. [CONFIRMED]
    - **Offline-First**: Mobile app must handle null/no-internet states gracefully. [CONFIRMED]
    - **Sovereignty**: Control of data within restricted zones (Exclusion zones). [CONFIRMED]
- **Tradeoffs Accepted**: 
    - Latency for high-severity alerts (due to HITL verification). [CONFIRMED]
    - Use of public RSS/News over classified feeds (easier to scale, harder to verify). [ASSUMED]
- **Tradeoffs Rejected**: 
    - Sending users into "Exclusion Zones" (Hard Block). [CONFIRMED]
    - Permanent user tracking (Identity rotation). [CONFIRMED]
- **Philosophical Assumptions**:
    - **AI Behavior**: Gemini 3 Pro is used for high-level reasoning; Gemini 2.5/2.0 Flash for speed/translation. AI is prone to "drift" if not for MD5 hash filtering. [CONFIRMED]
    - **Human Behavior**: Users will seek safety but may panic; UI uses "Pulsing Rings" to convey urgency visually. [CONFIRMED]
    - **Trust**: System trust is built on "Certified" (Admin-approved) status markers. [CONFIRMED]
    - **Control**: Decentralized clients, centralized brain. [CONFIRMED]

## 3. SYSTEM ARCHITECTURE
- **Component 1: Server Backend (The Intelligence Node)**
    - **Purpose**: Data ingestion, reasoning, state persistence.
    - **Inputs**: RSS Feeds, Google News, Zip/Lat-Lon lookups, Admin Commands.
    - **Outputs**: IntelDetails JSON, Server Logs, Status Reports.
    - **State**: Stateful (MongoDB for app data, SQLite for sessions).
    - **Authority**: High (Master source for clients).
    - **Dependencies**: Gemini API, MongoDB, Python environment.
    - **Failure Modes**: API quota limit, MongoDB connection loss.
- **Component 2: Android Frontend (The Tactical Interface)**
    - **Purpose**: Visualization for the end-user.
    - **Inputs**: IntelDetails JSON from Backend, GPS data.
    - **Outputs**: Map UI, Rationale popups, Evacuation routes.
    - **State**: Ephemeral (Local SharedPreferences, rotation every 24h).
    - **Authority**: Low (Consumer of server data).
    - **Dependencies**: Flutter SDK, OpenStreetMap.
    - **Failure Modes**: No network (Offline mode activated), GPS drift.
- **Component 3: Admin Console (The Command Controller)**
    - **Purpose**: Human-In-The-Loop verification and zone management.
    - **Inputs**: Raw AI intelligence reports, Admin Credentials, 2FA.
    - **Outputs**: Certified status updates, Exclusion zone injections.
    - **State**: Stateful (Django DB).
    - **Authority**: Absolute (Can override AI decisions).
    - **Dependencies**: Django, django-otp.
    - **Failure Modes**: Admin credential loss, TOTP desync.
- **Component 4: Control/Supervisory Logic**
    - **"The Panic Filter"**: Logical gate that downgrades AI-reported DEFCON 1-2 to "UNCONFIRMED" in the UI unless `is_certified` is true. [CONFIRMED]
    - **"Drift Filter"**: MD5 hashing of titles/links to prevent redundant AI processing. [CONFIRMED]

## 4. DATA FLOW & LIFECYCLE
1. **Ingestion**: `conflict_agent.py` fetches RSS feeds (Google News).
2. **Filtering**: MD5 check against `news_index`. Duplicate hashes update `last_seen` but skip AI analysis.
3. **Reasoning**: Context (User Location + News) is passed to `gemini-3-pro-preview`.
4. **Validation (Geospatial)**: `ZoneResolver` checks point against `Shapely` polygons in `core.compliance`. If in restricted zone, return hard block.
5. **Gating**: If AI suggests DEFCON 1 or 2, UI flag `is_certified` remains false until Admin manual POST.
6. **Storage**: Final JSON saved to `intel_history` (MongoDB).
7. **Pruning**: Threats older than 72 hours are rendered as grey/stale in the UI. [CONFIRMED]
8. **Memory Strategy**: Identity rotated every 24h; system status polls every 15s. [CONFIRMED]

## 5. BEHAVIORAL CONSTRAINTS & RULES
- **Hard Rules**:
    - Never generate intel for points inside Exclusion Zones.
    - Never display DEFCON 1-2 as "CONFIRMED" without human approval.
    - Rotate User ID every 24 hours.
- **Soft Rules**:
    - Optimize for mobile network latency (Gzip compression Level 6).
    - Use 5-second timeouts for VPS pings.
- **Override Conditions**: Admin Portal can manually set `is_certified = True`.
- **Uncertainty behavior**: System marks as "UNCONFIRMED" and adds "System Warnings" to the summary array.

## 6. USER INTERACTION MODEL
- **User Personas**: Civilians (Technical level: Low/Medium).
- **Assumed Sophistication**: High-stress environments; UI must be glanceable.
- **Tone**: Professional, tactical, serious. Dark-mode theme for evening/low-light usage. [CONFIRMED]
- **Authority**: Assistant posture. Provides options (Evac routes), not commands.
- **Dangerous Input**: Manual Lat/Lon entry into restricted zones is blocked by the compliance module.

## 7. MEMORY & CONTEXT STRATEGY
- **Persistence**: MongoDB stores history; SQLite stores sessions.
- **Forgotten data**: User GPS history is not stored long-term; identity is rotated for anonymity.
- **Validation**: AI-generated rations are verified via an "Agent Check" process before appearing in SITREPs.
- **Conflict Handling**: If new news contradicts old news, the `last_updated` field and MD5 index ensure the most recent context is weighted more heavily in the reasoning prompt.

## 8. SECURITY, SAFETY & FAILURE MODES
- **Risks**: API Key leak (Handled via env variables), Prompt injection in Admin Console.
- **Safeguards**: 2FA for Admin, CORS-allowed origins for Web/App, Hard blocks for restricted zones.
- **Worst-case**: AI hallucinating a safe route into a hazard. (Mitigated by human review and visual "Stale" markers).
- **Degradation**: If VPS is down, fallback to localhost is coded but primarily intended for dev usage. UI shows "Connecting" state if no response in 5s.

## 9. CURRENT STATE (As of Jan 14, 2026)
- **Implemented**: Full Backend (VPS), Admin Console, Android APK (Release), Nginx Reverse Proxy.
- **Partially Implemented**: iOS Frontend (Project structure exists, full parity verification pending).
- **Blocked**: None major; current focus is refinement and deployment verification.
- **Experimental**: AI-driven "Predictive" forecasting (Trend: Rising/Stable/Falling).
- **Fragile Assumptions**: VPS IP persistence (Dynamic vs Static IP), API quota reliability during high volume.

## 10. FUTURE ROADMAP
- **Next Steps**: Expand "Country Support" via CSV injection in `Developer Inputs`.
- **Long-term**: Integration with real-time satellite telemetry (Conceptual). [ASSUMED]
- **Pivot condition**: Significant move to sovereign AI hosting (avoiding cloud API dependencies).

## 11. META-INFORMATION
- **Designer Focus**: Reliability and correctness of the "Human-In-The-Loop" gate.
- **Success Definition**: Zero civilians entering known hazard zones due to system misinformation.
- **Failure Definition**: Use of the platform for offensive military targeting.
- **Common Misunderstanding**: That the system is "Real-Time Tracking" (it is RSS/News based with reasoning, not live sensor data).
- **Under-documented but Critical**: The interplay between `Djongo`, `sqlparse`, and `Django 4.1.13` versions (specific pins are required for Mac Silicon build stability).

END OF SENTINEL KNOWLEDGE DUMP
